# Resources
- Michael Sommer videos
- [Authentication Playlist - z3nsh3ll](https://www.youtube.com/playlist?list=PLWvfB8dRFqbbwmsFZg4vEkOxv9KmFCHrJ)
- [Authentication Playlist - Rana Khalil](https://www.youtube.com/playlist?list=PLuyTk2_mYISIZICCCdK7sLjKN1s1z9OQi)
# What is authentication
- Verify a user is who they claim to be
- Not to be confused with authorization
- Authorization is verifying whether or not a user is allowed to do something
# Password based authentication vulnerabilities
## Brute-force attacks
- Use:
    - Generict Wordlists
    - Fine tuned wordlists
    - Logic
    - Public knowledge
- Try to detect patterns in the naming convention of the company email
- Find First and Last names
- Check on the page, HTTP responses
### Username enumeration via the website's mechanism
- Registration Forms
- Login Page
- Password Reset
- Password Change
- Account lock
#### Check for differences in:
- HTTP Status Code
- Response message
    - Use Grep Extract to facilitate message comparison
    - Use negative search to facilitate message comparison
- Response times
    - Determine what triggers longer or shorter response times
    - Is there a parameter that's being validated that causes different response times?
- Typos
- Validation being done
## Flawed brute-force protection
- The accounts could be locking after failed attempts. This mechanism might hint at what usernames are valids and which are not.
- Blocking the remote IP address: The account unlocks after a successful login and the user can continue the attack
- IP Block/Restriction Bypass via header: Use the `X-Forwarded-For` to bypass IP restrictions
# 2FA Bypass
- See if application sets cookie without needing to provide the 2FA
- Study the 2FA logic steps. Try to find a flaw/step that would allow brute-forcing, omission, or bypass
# Vulnerabilities in other authentication mechanisms
- Stay-logged-in cookies: Look for faulty "encryption" or crackable patterns
    - XSS to extract cookie data and then crack the data
- Password reset functionality:
    - Check for flaws in the steps
    - See if uuid or other parameters are being validated
    - Header Injection: Use `X-Forwarded-Host` header to redirect responses via middleware and log any sensitive token
- Password Change
    - If the  current password is needed, is there a way to enumerate the current password?
    - Test different scenarios to see the different messages that are generated by the functionality:
        - Correct current password
        - Incorrect current password
        - Matching new password
        - Unmatching new password
